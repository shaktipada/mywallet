{% extends 'base.html' %}
{% block head_title %} MyWallet {% endblock head_title %}
{% block body_content %}
	<h2 class="text-center">Welcome to MyWallet</h2>
	</br></br>
	<div class="row">
		<div class="col-lg-5 col-md-5 col-sm-5 col-xs-5">
			<div id='signup'>
				<h4 class='text-center'>Sign Up</h4>
      	{% csrf_token %}
				<form role="form" action="" method="post" accept-charset="utf-8" id='signup_form'>
  				<div class="form-group">
				    <label for="first_name"></label>
						<input id='first_name' class="form-control" type="text" name="first-name" value="" placeholder="First Name / Merchant Name">
					</div>
  				<div class="form-group">
				    <label for="last_name"></label>
						<input id='last_name' class="form-control" type="text" name="last-name" value="" placeholder="Last Name / Merchant Name">
					</div>
  				<div class="form-group">
				    <label for="email"></label>
						<input id='email' class="form-control" type="email" name="email" value="" placeholder="Email ID">
					</div>
  				<div class="form-group">
				    <label for="contact_number"></label>
						<input id='contact_number' class="form-control" type="phone" name="contact_number" value="" placeholder="Mobile no.">
					</div>
  				<div class="form-group">
				    <label for="username"></label>
						<input id='username' class="form-control" type="text" name="username" value="" placeholder="Username / EmailID">
					</div>
  				<div class="form-group">
				    <label for="passcode"></label>
						<input id='passcode' class="form-control" type="password" name="password" value="" placeholder="Password">
					</div>
					<div class="form-group">
				    <label for="confirm_passcode"></label>
						<input id='confirm_passcode' class="form-control" type="password" name="confirm-passcode" value="" placeholder="Confirm Password">
					</div>
					<div class="form-group">
				    <label for="type"></label>
						<label class="checkbox-inline">
							<input id="biller_signup" type="checkbox" value="">Merchant (Check if Merchant)
						</label>
						<input id='signup_type' class="form-control" type="hidden" name="type" value="customer">
					</div>
					<button type="" id='submit_signup' class='btn btn-danger btn-lg'>Submit</button>
				</form>
			</div>
		</div>
		<div class="col-lg-2 col-md-2 col-sm-2 col-xs-2">
			<h4 class='text-center'> Or </h4>
		</div>
		<div class="col-lg-5 col-md-5 col-sm-5 col-xs-5">
			<div id='signin'>
				<h4 class='text-center'>Sign In</h4>
      	{% csrf_token %}
				<form role="form" action="" method="post" accept-charset="utf-8" id='signin_form'>
					<div class="form-group">
				    <label for="username"></label>
						<input id='username' class="form-control" type="text" name="username" value="" placeholder="Username / EmailID / Mobile no.">
					</div>
					<div class="form-group">
				    <label for="password"></label>	
						<input id='password' class="form-control" type="password" name="password" value="" placeholder="Password">
					</div>
					<div class="form-group">
				    <label for="type"></label>
						<label class="checkbox-inline">
							<input id="biller_signin" type="checkbox" value="">Merchant (Check if Merchant)
						</label>
						<input id='signin_type' class="form-control" type="hidden" name="type" value="customer">
					</div>
					<button type="" id='submit_signin' class='btn btn-danger btn-lg'>Submit</button>
				</form>
			</div>
		</div>
	</div>
{% endblock body_content %}

{% block java_scripts %}
	  <script>
    	$(document).ready(function(){
    		
      	$('#biller_signin').click(function(event) {
    			if ($('#biller_signin').is(':checked')){
        		$('#signin #signin_type').val('biller');
        	}
        	else {
        		$('#signin #signin_type').val('customer');
        	}
      	});
      	$('#biller_signup').click(function(event) {
	        if ($('#biller_signup').is(':checked')){
		        $('#signup #signup_type').val('biller');
		      }
		      else {
		        $('#signup #signup_type').val('customer');
		      }
		    });

      	$('#submit_signin').click(function(event) {
					event.preventDefault();
        	$("#signin #submit_signin").button('loading');
	      	console.log($( "form#signin_form" ).serializeArray());
      		$.ajax({
            type: 'POST',
            url: "{% url 'signin' %}",
            data: $( "form#signin_form" ).serializeArray(),
            dataType: 'json',
            success: function(results) {
	            	console.log(results);
	            	if ('customer' in results){
	            		console.log("hello");
	            	}
	            	//location.href = "{% url 'dashboard_home' %}";
            },
            error: function(xhr, status, error){
	            	console.log(error);
            }
      		});
      	});

      	$('#submit_signup').click(function(event) {
					event.preventDefault();
      		var password = $('#passcode').val();
      		var confirm_password = $('#confirm_passcode').val();
      		if (password == confirm_password) {
	      		$("#signup #submit_signup").button('loading');
	      		console.log($( "form#signup_form" ).serializeArray());
	      		$.ajax({
	            type: 'POST',
	            url: "{% url 'signup' %}",
	            data: $( "form#signup_form" ).serializeArray(),
	            dataType: 'json',
	            success: function(results) {
	            	console.log(results);
	            },
	            error: function(xhr, status, error){
	            	console.log(error)
	            }
	      		});	
      		}
      		else {
    				alert("Password mismatch");
    				$('#passcode').val('');
      			$('#confirm_passcode').val('');
      		}
      	});
    	
    	});
  	</script>
{% endblock java_scripts %}
